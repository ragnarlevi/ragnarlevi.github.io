<html>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>Ragnar - Generalized Lienar Models </title><meta content="Model" name=keywords>
<meta content="Ragnar - In this notebook, I am going to note down elements of generalized linear models (GLM). GLMs come from the exponential family where a response $y$ has the following distribution $$f(y;\theta) =\exp\Big(\frac{y\theta - b(\theta)}{a(\phi)} + c(y,\theta)\Big)$$ where $\theta$ is the canonical parameter and $\phi$ is the dispersion parameter. Before continuing we define the score and derive the a formula for the expected score and the information.
The score is the derivative of the log-likelihood and we can derive the expected score as, using $f = f(y;\theta)$ :" name=description>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet href=/layui/css/layui.css>
<link rel=stylesheet href=/self/css/default.css>
<script src=/layui/layui.js></script>
<link rel=stylesheet async href=/self/css/markdown.min.css>
<link rel=stylesheet async href=/self/css/gallery.css>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous>
<script async src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js integrity="sha256-h2tMEmhemR2IN4wbbdNjj9LaDIjzwk2hralQwfJmBOE=" crossorigin=anonymous></script></head><body>
<header>
<script type=text/x-mathjax-config>
      MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
          tex2jax: { inlineMath: [ ["$", "$"], ["\\(", "\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
          TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
          messageStyle: "none"
      });
  </script>
<script type=text/javascript src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</header><header class="layui-header layui-bg-cyan">
<a class=nav-self-logo href=/>
Ragnar
</a>
<ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter>
<li class=layui-nav-item id=nav_big><a href=/post/>Posts</a></li><li class=layui-nav-item id=nav_big><a href=/about/>About</a></li><li class=layui-nav-item id=nav_small>
<a href=javascript:;>
<i class="layui-icon layui-icon-app" style=font-size:24px></i>
</a>
<dl class=layui-nav-child>
<dd><a href=/post/>Posts</a></dd><dd><a href=/about/>About</a></dd></dl></li></ul></header><script>layui.use("element",function(){var e=layui.element})</script>
<div id=content style=min-height:80%>
<div class=layui-container style=margin-bottom:10px>
<div class="layui-row layui-col-space10">
<div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
<div class="layui-card single-card">
<br>
<blockquote class="self-elem-quote self-elem-quote-bg-red markdown-body single-title">
<h1>Generalized Lienar Models</h1><h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2022-03-02</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/model/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Model</span>
</a>
</h3></blockquote><div class="layui-card-body markdown-body single-content">
<p>In this notebook, I am going to note down elements of generalized linear
models (GLM). GLMs come from the exponential family where a response $y$
has the following distribution
$$f(y;\theta) =\exp\Big(\frac{y\theta - b(\theta)}{a(\phi)} + c(y,\theta)\Big)$$
where $\theta$ is the canonical parameter and $\phi$
is the dispersion parameter. Before continuing we define the score and
derive the a formula for the expected score and the information.</p><p>The score is the derivative of the log-likelihood and we can derive the
expected score as, using $f = f(y;\theta)$
:</p><p>$$
\begin{equation}
\begin{split}
E[\frac{\partial}{\partial\theta}\log f] &= E[\frac{1}{f}\frac{\partial}{\partial\theta} f]\\\
&=\int\frac{1}{f}\frac{\partial f}{\partial\theta} fdx\\\
&=\frac{\partial }{\partial\theta}\int fdx\\\
&=\frac{\partial }{\partial\theta} 1 = 0
\end{split}
\end{equation}
$$</p><p>This formula gives us the mean function $E[y] =\mu = b&rsquo;(\theta)$
. The information equality is:</p><p>$$
\begin{split}
E\Big[\frac{\partial^2}{\partial\theta\partial\theta^T}\log f\Big] &= E\Big[\frac{\partial}{\partial\theta} (\frac{1}{f}\frac{\partial f}{\partial\theta^T})\Big]\\\
&= -E\Big[\frac{1}{f^2}\frac{\partial f}{\partial\theta}\frac{\partial f}{\partial\theta^T}\Big] + E\Big[\frac{1}{f}\frac{\partial^2 f}{\partial\theta\partial\theta^T}\Big]\\\
&= -E\Big[\frac{1}{f^2}\frac{\partial f}{\partial\theta}\frac{\partial f}{\partial\theta^T}\Big]\\\
&= - E\Big[ (\frac{\partial\log f}{\partial\theta})(\frac{\partial\log f}{\partial\theta})^T\Big]
\end{split}
$$</p><p>Which can be seen as $Var(\frac{\partial}{\partial\theta}\log f) = - E\Big[\frac{\partial^2}{\partial\theta\partial\theta^T}\log f\Big]$. The information equality gives the variance function $Var(y) = a(\phi)b&rsquo;&rsquo;(\theta)$. GLMs make use of a linear predictor $\eta = x^T\beta$ where $x$ is a vector of features and $\beta$ the regression parameters to be estimated. The third part of GLMs is the
link function, which connects $\eta$ to $\mu$ via a function $g$, $g(\mu) =\eta$
.</p><p>A typical example is the binomial response model $y\sim Bin(n,\pi)$
gives:
$$\log f =\frac{y\log(\frac{\pi}{1-\pi}) +\log(1-\pi)}{1} + const$$
The canonical parameter is $\theta =\log(\frac{\pi}{1-\pi})$ and $\phi = 1$ Another example is the Poisson response model, $y\sim Poi(\lambda)$
which gives
$$\log f =\frac{y\log(\lambda) -\lambda}{1} + const$$
Here the canonical parameter is $\theta =\log(\lambda)$ and $\phi = 1$ When $\eta =\theta$
we say that the model has a canonical link. It is often convenient to
use a canonical link but that does not mean that the data is actually
generated from that model. This has to be checked using some
diagnostics.</p><p>When we fit GLM models we calculate need to calculate the derivative of
the log-likelihood $l$ $$\frac{\partial l}{\partial\beta_i} =\frac{\partial l}{\partial\theta}\frac{\partial\theta}{\partial\mu}\frac{\partial\mu}{\partial\eta}\frac{\partial\eta }{\partial\beta_i}$$
</p><p>We have:
$$\frac{\partial l}{\partial\theta} =\frac{y-b&rsquo;(\theta)}{a(\phi)} =\frac{y-\mu}{a(\phi)}$$
using the fact that $\mu = b&rsquo;(\theta)$ and that $f&rsquo;(x) =\frac{1}{(f^{-1})&rsquo;(y)}$
we have:
$$\frac{\partial\theta}{\partial\mu} =\frac{1}{b&rsquo;&rsquo;(\theta)} =\frac{a(\phi)}{Var(y)}$$ $\frac{\partial\mu}{\partial\eta}$ will depend on the link and $\frac{\partial\eta }{\partial\beta_i} = x_{ji}$. If we use a canonical link we have $\frac{\partial\mu}{\partial\eta} =\frac{\partial\mu}{\partial\theta} = b&rsquo;&rsquo;(\theta)$
. Also if we use a canonical link than Fisher scoring optimization
procedure is the same thing as Newton-Raphson optimization.</p><p>The dispersion parameter is usually fitted separately using a
traditional estimate of the variance.</p><p>Finally to comment on diagnostics. We can inspect the residuals, either
the Pearson residual defined as
$$r_i =\frac{y_i -\widehat{\mu}}{\sqrt{\widehat{Var}(y)}}=\frac{y_i -\widehat{\mu}}{\sqrt{a(\hat{\phi})V(\hat{\mu})}}$$
</p><p>or the deviance residual</p><p>$r_i = sign(y-\mu)\sqrt{d}_i$</p><p>where $d_i$ is the deviance of observation $i$. If we plot the $\hat{\eta}$ as a function of the residuals, we should see a horizontal band with
mean approximately zero, something similar to a whitenoise. If there is
a curvature in the plot then we might have a wrong link function or we
are missing some nonlinear feature, for example $x^2$
. If the horizontal band is not symmetric, not symmetric, or many
outliers then the variance function may be incorrect, for example too
low or high dispersion.</p><p>If we plot individual features vs residuals vs we should also get a
horizontal band. A curvature suggest that the feature should be
nonlinear</p><p>If we plot the fitted values vs absolute residuals and do not see any
trend, then the variance function is ok. However, if there is a trend
then the variance function is incorrect. However, if we are in a certain
paramteric family then we can not really change the variance function.
However, we could perform a quasi-likelihood approach.</p><p>The main idea of the quasi-likelihood is to relax the exponential family
assumption and allow a more general variance component $\phi V(\mu)$ to define a quasi-score $\tilde{S} =\frac{y-\mu}{\phi V(\mu)}$. The quasi-score is similar to the score, namely, it satisfies the
expected score and information formulas $E[\tilde{S}]$ and $Var(\tilde{S}) =\frac{1}{\phi V(\mu)}$. As the score is the derivative of the log-likelihood, the quasi
log-likelihood $Q$
is the integral of the quasi score:
$$Q(y;\mu) =\int_{y}^\mu\frac{y-t}{\phi V(t)} dt $$
</p></div></div></div><div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
<div class="layui-card single-card">
<h2 class=single-title>Relevant Topics</h2><div style=margin-left:10px>
<blockquote class="self-elem-quote self-elem-quote-bg-red" style=background-color:#fff;margin-top:10px>
<a href=/post/hmm/>
<h3>Hidden Markov Models</h3></a>
<h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2022-02-15</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/model/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Model</span>
</a>
<a href=/tags/classification/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Classification</span>
</a>
</h3></blockquote></div><br>
</div><div class="layui-card single-card">
<h2 class=single-title>Recent Posts</h2><div style=margin-left:10px>
<blockquote class="self-elem-quote self-elem-quote-bg-red" style=background-color:#fff;margin-top:10px>
<a href=/post/glm/>
<h3>Generalized Lienar Models</h3></a>
<h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2022-03-02</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/model/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Model</span>
</a>
</h3></blockquote></div><div style=margin-left:10px>
<blockquote class="self-elem-quote self-elem-quote-bg-red" style=background-color:#fff;margin-top:10px>
<a href=/post/hmm/>
<h3>Hidden Markov Models</h3></a>
<h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2022-02-15</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/model/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Model</span>
</a>
<a href=/tags/classification/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Classification</span>
</a>
</h3></blockquote></div><div style=margin-left:10px>
<blockquote class="self-elem-quote self-elem-quote-bg-red" style=background-color:#fff;margin-top:10px>
<a href=/post/extremes/>
<h3>Quntitative Risk Analysis</h3></a>
<h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2021-11-17</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/risk/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Risk</span>
</a>
<a href=/tags/extremes/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Extremes</span>
</a>
</h3></blockquote></div><div style=margin-left:10px>
<blockquote class="self-elem-quote self-elem-quote-bg-red" style=background-color:#fff;margin-top:10px>
<a href=/post/deepkernel/>
<h3>Deep Graph Kernels</h3></a>
<h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2021-11-16</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/graph/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Graph</span>
</a>
<a href=/tags/classification/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Classification</span>
</a>
<a href=/tags/kernel/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Kernel</span>
</a>
</h3></blockquote></div><div style=margin-left:10px>
<blockquote class="self-elem-quote self-elem-quote-bg-red" style=background-color:#fff;margin-top:10px>
<a href=/post/correlationnetwork/>
<h3>Group Identification in Stock Markets</h3></a>
<h3 style=margin-top:10px;margin-bottom:10px>
<i class="layui-icon layui-icon-date" style=font-size:28px;vertical-align:-2px></i>
<span>2021-09-16</span>
<i class="layui-icon layui-icon-tabs" style=font-size:22px;vertical-align:1px;margin-right:2px></i>
<a href=/tags/risk/>
<span class="layui-badge layui-bg-orange" style=vertical-align:2px>Risk</span>
</a>
</h3></blockquote></div><br>
</div></div></div></div></div><footer>
<div class=layui-container>
<p class=copyright>&copy; All rights reserved. Powered by <a href=https://gohugo.io style=color:#fff>Hugo</a>, <a href=https://github.com/ertuil/erblog style=color:#fff>Erblog</a> and <a href=https://github.com/vlunot/nb2hugo style=color:#fff>nb2hugo</a>.</p></div></footer></body></html>